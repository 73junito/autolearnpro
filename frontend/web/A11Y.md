# Accessibility (A11Y) Checks

This document explains how to run the accessibility scans locally and how the GitHub Actions job behaves.

Local Playwright browser scan

1. Install dev deps (one-time):

```bash
cd frontend/web
npm install
npx playwright install --with-deps chromium
```

2. Run the Playwright runner (starts the built server, runs scan, writes `a11y-playwright.json`):

```bash
# from repo root
cd frontend/web
node tools/run_playwright_scan.js
```

3. Validate the report (exit non-zero when violations exist):

```bash
node tools/a11y_check_exit.js a11y-playwright.json
```

Static (jsdom) scan

1. Build the site so prerendered HTML exists:

```bash
cd frontend/web
npm run build
```

2. Run the file-based scan (reads `.next/server/app/<page>.html`):

```bash
node tools/a11y_scan_file.js .next/server/app/courses.html a11y-report.json
```

CI behavior

- The workflow is `.github/workflows/a11y-playwright.yml`.
-- By default the job now runs in report-only mode (`REPORT_ONLY` defaults to `'true'`).
-- The workflow exposes a `workflow_dispatch` input `report_only` (default: `'true'`) so you can manually trigger runs with `report_only: 'false'` to make the job fail on violations.

Interpreting reports

- `a11y-playwright.json` contains `violations`, `passes`, and `incomplete` arrays from `axe-core`.
- Use `node tools/a11y_check_exit.js a11y-playwright.json` to fail when `violations.length > 0`.

Troubleshooting

- If Playwright cannot connect to the site, ensure no other process is occupying port 3000 and that `node`/`npm` are available on PATH.
- If a page uses client-only rendering, the Playwright scan (browser) is preferred over jsdom static scans.

Questions or changes

If you want the workflow to be report-only by default, I can flip `REPORT_ONLY` to `'true'` and/or add a workflow input to toggle it per run.
